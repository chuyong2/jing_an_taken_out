![项目使用技术](https://user-images.githubusercontent.com/88364565/197378938-d3d29ad6-245d-4924-8968-618bb38cc7b4.png)
### 学习项目收获：
 - 了解企业项目开发的完整流程，增长开发经验
 - 了解需求分析的过程，提高分析和设计能力
 - 对所学技术进行灵活应用，提高编码能力
 - 解决各种异常情况，提高代码调试能力
## 项目介绍
本项目是专门为餐饮企业（餐厅、饭店）定制的一款软件产品，包括系统管理后台和移动端应用两部分。其中系统管理后台主要提供给餐饮企业内部员工使用，可以对餐厅的菜品、套餐、订单等进行管理维护。移动端应用主要提供给消费者使用，可以在线浏览菜品、添加购物车、下单等。
## 功能结构
### 移动端前台
 - 手机号登录     
 - 微信登陆      
 - 地址管理       
 - 历史订单       
 - 菜品规格
 - 菜品规格
 - 购物车
 - 下单
 - 菜品浏览
### 系统管理后台
 - 分类管理
 - 菜品管理
 - 套餐管理
 - 菜品口味管理
 - 员工登录
 - 员工退出
 - 员工管理
 - 订单管理
## 角色
 - 后台系统管理员：登录后台管理系统，拥有后台系统中的所有操作权限
 - 后台系统普通员工：登录后台管理系统，对菜品、套餐、订单等进行管理
 - C端用户：登录移动端应用，可以浏览菜品、添加购物车、设置地址、在线下单等
## 数据库设计
![image](https://user-images.githubusercontent.com/88364565/197379518-86b5d20f-5b27-4528-87b8-9e9d0ab70f6f.png)
## 后台登录功能开发
### 需求分析
查看登录请求信息，通过浏览器调试工具（F12），可以发现，点击登录按钮时，页面会发送请求（请求地址为http://localhost:/8080/employee/login）并提交参数（username和password）
此时报404，是因为我们的后台系统还没有响应此请求的处理器，所以我们需要创建相关类来处理登录请求
![image](https://user-images.githubusercontent.com/88364565/197379726-14746db8-3805-4ca8-b1c5-6d7194c94b38.png)
### 代码开发
处理逻辑如下：
 - 将页面提交的密码password进行md5加密处理                                   ![image](https://user-images.githubusercontent.com/88364565/197379942-cf6422b6-172a-4d43-9760-4551f275e6ab.png)
 - 根据页面提交的用户名username查询数据库
 - 如果没有查询到则返回登录失败结果
 - 密码比对，如果不一致则返回登录失败结果
 - 查看员工状态，如果为已禁用状态，则返回员工已禁用结果
 - 登录成功，将员工id存入Session并返回登录成功结果
## 后台退出功能开发
### 需求分析
员工登录成功后，页面跳转到后台系统首页面（backend/index.html），此时会显示当前登录用户的姓名，如果员工需要退出系统，直接点击石侧的退出按钮即可退出系统，退出系统后页面应跳转回登录页面
### 代码开发
 用户点击页面中退出按钮，发送求，请求地址为/employee/logout，请求方式为POST。我们只需要在Controller中创建对应的处理方法即可，具体的处理逻辑
 - 清理Session中的用户id
 - 返回结果
## 完善登录功能（拦截）
### 问题分析                                              Q
前面我们已经完成了后台系统的员工登录功能开发，但是还存在一个问题：用户如果不登录，直接访问系统首页面，照样可以正常访问。
这种设计并不合理，我们希望看到的效果应该是，只有登录成功后才可以访问系统中的页面，如没有登录则跳转到登录页面。
那么，具体应该怎么实现呢
答案就是使用过滤器或者拦器，在过滤器或者拦载器中判断用户是否已经完成登录， 如没有登录则跳转到登录页面
### 代码实现
 - 创建自定义过滤器LogincheckFilter
 - 在启动类上加入注解@servletcomponentscan
 - 完善过滤器的处理逻辑
![image](https://user-images.githubusercontent.com/88364565/197380404-8d977ad1-ab9e-44b0-b100-f3d689c6bd90.png)

过滤器具体的处理逻辑如下：
 - 获取本次请求的URI
 - 判断本次请求是否需要处理
 - 如果不需要处理，则直接放行
 - 判断登录状态，如果已登录，则直接放行
 - 如果未登录则返回未登录结果
## 新增员工
### 数据模型
新增员工，其实就是将我们新增页面录入的员工数据插入到employee表。需要注意，employee表中对username字段加入了唯一约束，因为username是员工的登录账号，必须是唯一的
status默认值为1（1为正常，0为未启用）
### 代码开发
在开发代码之前，需要梳理一下整个程序的执行过程
 - 页面发送ajax请求，将新增员工页面中输入的数据以json的形式提交到服务端
 - 服务端Controller接收页面提交的数据并调用Service将数据进行保存
 - Service调用Mapper操作数据库，保存数据
![image](https://user-images.githubusercontent.com/88364565/197380641-dcb701e6-35c1-49ea-8e01-c772763fdf21.png)
### 发现问题
前面的程序还存在一个问题，就是当我们在新增员工时输入的账号已经存在，由于employee表中对该字段加入了唯一约束，此时程序会抛出异常：java. sql. SQLIntegrityConstraintViolationException: Duplicate entryzhangsan for keyidx_username。此时需要我们的程序进行异常捕获，通常有两种处理方式
 - 在Controller方法中加入try、catch进行异常捕获 
 - 使用异常处理器进行全局异常获
### 小结
1、根据产品原型明确业务需求
2、重点分析数据的流转过程和数据格式
3.通过debug断点调试跟踪程序执行过程
## 员工信息分页查询
员工数据多了就要分页显示，否则杂乱无章
### 代码开发
在开发代码之前，需要梳理一下整个程序的执行过程
 - 页面发送ajax请求，将分页查询参数（page、pagesize、name）提交到服务端
 - 服务端Controller接收页面提交的数据并调用ervice查询数据
 - Service调用Mapper操作数据库，查询分页数据
 - Controller将查询到的分页数据响应给页面
 - 页面接收到分页数据并通过Elementul的Table组件展示到页面上
![image](https://user-images.githubusercontent.com/88364565/197380958-90741c70-e720-4096-979e-4955fd2f2184.png)














